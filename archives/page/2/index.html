
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Shawn&#39;s Pitstop">
    <title>Archives - Shawn&#39;s Pitstop</title>
    <meta name="author" content="Shawn Xu">
    
    
    
        
            <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss2.xml">
        
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Shawn&#39;s Pitstop">
<meta property="og:url" content="https://xunnanxu.github.io/archives/page/2/index.html">
<meta property="og:site_name" content="Shawn&#39;s Pitstop">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Shawn Xu">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://miro.medium.com/fit/c/90/90/1*7cPXDgvy2_tKMHR4SEd-yQ.jpeg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-yvywglw62lgxwz25dsjvepo05oagkygdd7st7xfdzhmmxwqoijtiy3ngabtp.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-83953865-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-83953865-1');
    </script>


    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/%20"
            aria-label=""
        >
            Shawn&#39;s Pitstop
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="https://miro.medium.com/fit/c/90/90/1*7cPXDgvy2_tKMHR4SEd-yQ.jpeg" alt="Author&#39;s picture"/>
        
        </a>
    
    <script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';</script>
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="https://miro.medium.com/fit/c/90/90/1*7cPXDgvy2_tKMHR4SEd-yQ.jpeg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Shawn Xu</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Software Engineer in Bay Area</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/xunnanxu"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2016/10/01/You-Don-t-Know-JS-Eval/"
                            aria-label=": You Don&#39;t Know JS - Eval"
                        >
                            You Don&#39;t Know JS - Eval
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-10-01T16:03:31-07:00">
	
		    Oct 01, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/You-Don-t-Know-JS/">You Don't Know JS</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="table-of-contents">Table of Contents</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Have-you-seen-eval-written-like-this"><span class="toc-text">Have you seen eval() written like this?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Regular-eval"><span class="toc-text">Regular eval</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Global-eval"><span class="toc-text">Global eval</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Back-to-the-original-topic"><span class="toc-text">Back to the original topic</span></a></li></ol>

<p>Recently I’ve been writing quite a bit of front-end stuff and seen quite a few tricks from other people’s libraries. It turns out JavaScript is a pretty <del>wonky and fked up</del> interesting language, which tempts me to write a series about it and this is the first one. This is by no means supposed to show how to write JS but just to show some “wacky” stuff.</p>
<h2 id="Have-you-seen-eval-written-like-this"><a href="#Have-you-seen-eval-written-like-this" class="headerlink" title="Have you seen eval() written like this?"></a>Have you seen eval() written like this?</h2><pre><code>(0, eval)(&apos;something&apos;);</code></pre><img src="http://www.memes.at/faces/are_you_fucking_kidding_me.jpg" alt="Are you fucking kidding me" style="width:200px">

<h2 id="Regular-eval"><a href="#Regular-eval" class="headerlink" title="Regular eval"></a>Regular eval</h2><p>Eval basically allows you to execute any script within the given context.</p>
<p>For example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;console.log(&quot;123&quot;);&#x27;</span>);            <span class="comment">// prints out 123</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">a</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&#x27;console.log(this.a);&#x27;</span>);            <span class="comment">// 1</span></span><br><span class="line">&#125;)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>So far everything is normal: eval runs inside the current scope. <code>this</code> is pointed to the instance of A.</p>
<h2 id="Global-eval"><a href="#Global-eval" class="headerlink" title="Global eval"></a>Global eval</h2><p>Things get interesting when you do this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> someVar = <span class="string">&#x27;outer&#x27;</span>;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">someVar</span> = <span class="string">&#x27;inner&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">&#x27;console.log(someVar);&#x27;</span>);       <span class="comment">// you may want &#x27;outer&#x27; but this says &#x27;inner&#x27;</span></span><br><span class="line">&#125;)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Well in this scenario eval cannot get the value of someVar in the global scope.</p>
<p>However ECMA5 says, if you change <code>eval()</code> call to indirect, in other words, if you use it as a value rather than a function reference, then it will evaluate the input in the global scope.</p>
<p>So this would work:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> someVar = <span class="string">&#x27;outer&#x27;</span>;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> geval = <span class="built_in">eval</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">someVar</span> = <span class="string">&#x27;inner&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">geval</span>(<span class="string">&#x27;console.log(someVar);&#x27;</span>);       <span class="comment">// &#x27;outer&#x27;</span></span><br><span class="line">&#125;)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Although <code>geval</code> and <code>eval</code> call the exact same function, <code>geval</code> is a value and thus it becomes an indirect call according to ECMA5.</p>
<h2 id="Back-to-the-original-topic"><a href="#Back-to-the-original-topic" class="headerlink" title="Back to the original topic"></a>Back to the original topic</h2><p>So what the hell is <code>(0, eval)</code> then? Well a comma separated expression list evaluates to the last value, so it essentially is a shortcut to</p>
<pre><code>var geval = eval;
geval(...);</code></pre><p>0 is only a puppet here. It could be any value.</p>
<img src="http://www.memes.at/faces/so_much_win.jpg" alt="So much win" style="width:200px">
                    
                        


                    
                    
                        <p>
                            <a
                                href="/2016/10/01/You-Don-t-Know-JS-Eval/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-right">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2016/09/18/Why-you-should-ditch-browserify-and-commonjs-in-the-http-2-world/"
                            aria-label=": Why you should ditch Browserify and CommonJS in the http/2 world"
                        >
                            Why you should ditch Browserify and CommonJS in the http/2 world
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-09-18T10:15:36-07:00">
	
		    Sep 18, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Frontend/">Frontend</a>


    
</div>

            </div>
            
                <div class="postShorten-excerpt">
                    <div class="alert info no-icon"><p>Stop bundling in the http/2 world since it does it for you.</p>
</div>

<!-- toc -->

<h1 id="Modularization-is-a-great-idea"><a href="#Modularization-is-a-great-idea" class="headerlink" title="Modularization is a great idea"></a>Modularization is a great idea</h1><p>Back in the old days where there were no concept regarding frontend package management, we would lay out all the scripts in order in the html file, and hope for the best that they would somehow work together if order were right. This surely doesn’t work well with huge projects, but luckily back then JavaScripts weren’t so shiny anyways - UIs weren’t so cool and logic was much simpler. However, things do evolve. People soon noticed that this approach wouldn’t scale - cooperation across multiple teams becomes super tricky, if not impossible, and it doesn’t play well with DRY either.</p>
<p>Then people came up with a great idea of modularizing JS code (probably back in 2003?) the same way you would do for your beloved Java/C++ code libraries. And then there came the CommonJS definition concept by Kevin Dangoor back in 2009. Many people got to know this idea thanks to Node.js, and it works quite well, especially for server side code. Now you can easily use npm and build both the frontend and backend using the same tool very quickly, thanks to the JS community. Since people have the same interface for code modularization, team cooperation becomes much easier and projects gain benefit from much better encapsulation.</p>
                    
                        <a
                            href="/2016/09/18/Why-you-should-ditch-browserify-and-commonjs-in-the-http-2-world/"
                            class="postShorten-excerpt_link link"
                            aria-label=": Why you should ditch Browserify and CommonJS in the http/2 world"
                        >
                            Continue reading
                        </a>
                        
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-right">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2016/09/10/It-s-all-about-buffers-zero-copy-mmap-and-Java-NIO/"
                            aria-label=": It&#39;s all about buffers: zero-copy, mmap and Java NIO"
                        >
                            It&#39;s all about buffers: zero-copy, mmap and Java NIO
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-09-10T01:00:27-07:00">
	
		    Sep 10, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/OS/">OS</a>


    
</div>

            </div>
            
                <div class="postShorten-excerpt">
                    <p>There are use cases where data need to be read from source to a sink without modification. In code this might look quite simple: for example in Java, you may read data from one <code>InputStream</code> chunk by chunk into a small buffer (typically 8KB), and feed them into the <code>OutputStream</code>, or even better, you could create a <code>PipedInputStream</code>, which is basically just a util that maintains that buffer for you. However, if low latency is crucial to your software, this might be quite expensive from the OS perspective and I shall explain.</p>
<h2 id="What-happens-under-the-hood"><a href="#What-happens-under-the-hood" class="headerlink" title="What happens under the hood"></a>What happens under the hood</h2><p>Well, here’s what happens when the above code is used:</p>
<img src="/2016/09/10/It-s-all-about-buffers-zero-copy-mmap-and-Java-NIO/non_zero_copy.png" class="">

<ol>
<li>JVM sends read() syscall. </li>
<li>OS context switches to kernel mode and reads data into the input socket buffer.</li>
<li>OS kernel then copies data into user buffer, and context switches back to user mode. read() returns.</li>
<li>JVM processes code logic and sends write() syscall.</li>
<li>OS context switches to kernel mode and copies data from user buffer to output socket buffer.</li>
<li>OS returns to user mode and logic in JVM continues.</li>
</ol>
                    
                        <a
                            href="/2016/09/10/It-s-all-about-buffers-zero-copy-mmap-and-Java-NIO/"
                            class="postShorten-excerpt_link link"
                            aria-label=": It&#39;s all about buffers: zero-copy, mmap and Java NIO"
                        >
                            Continue reading
                        </a>
                        
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-right">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2016/08/14/get-started-with-hexo-blogging-system/"
                            aria-label=": Get Started with Hexo Blogging System"
                        >
                            Get Started with Hexo Blogging System
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-08-14T14:32:53-07:00">
	
		    Aug 14, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Hexo/">Hexo</a>


    
</div>

            </div>
            
                <div class="postShorten-excerpt">
                    <h1 id="You-should-read-this-if"><a href="#You-should-read-this-if" class="headerlink" title="You should read this if"></a>You should read this if</h1><ul>
<li>You want to set up a personal blog</li>
<li>You know what <a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet">Markdown</a> is</li>
<li>You don’t want to set up a heavy Wordpress environment</li>
<li>You don’t want to set up any database just for the blog</li>
<li>You either don’t have a VPS or want to host blog content in some easy-to-reach place.</li>
<li>You still want a template/theme system.</li>
</ul>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>Github Pages + Hexo (what this site uses)</p>
                    
                        <a
                            href="/2016/08/14/get-started-with-hexo-blogging-system/"
                            class="postShorten-excerpt_link link"
                            aria-label=": Get Started with Hexo Blogging System"
                        >
                            Continue reading
                        </a>
                        
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
          <li class="pagination-prev">
            <a
                class="btn btn--default btn--small"
                href="/archives/"
                aria-label="NEWER POSTS"
            >
              <i class="fa fa-angle-left text-base icon-mr"></i>
              <span>NEWER POSTS</span>
            </a>
          </li>
        
        
        <li class="pagination-number">page 2 of 2</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Shawn Xu. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://miro.medium.com/fit/c/90/90/1*7cPXDgvy2_tKMHR4SEd-yQ.jpeg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Shawn Xu</h4>
        
            <div id="about-card-bio"><p>Software Engineer in Bay Area</p>
</div>
        
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-a5wszscostah6olx2wgfq7mglfmluysmmlvnxgmmszk3gwouxhlbwbsk0xkf.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
